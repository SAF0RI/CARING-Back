#!/usr/bin/env python3
"""
질문 데이터 초기화 스크립트
이 스크립트는 question 테이블에 기본 질문들을 저장합니다.
"""

import json
from app.database import engine, SessionLocal
from app.models import Question


def init_questions():
    """질문 데이터 초기화"""
    # 질문 데이터
    questions_data = {
        "emotion": [
            "오늘 기분을 한 단어로 표현하면 무엇인가요?",
            "오늘 감정이 크게 오르내린 적이 있나요?",
            "지금 기분에 색을 하나 고른다면 무슨 색인가요?",
            "오늘 기분이 좋아지게 한 소리나 음악이 있었나요?",
            "지금 기분을 음식으로 비유하면 무엇인가요?",
            "오늘 하루를 한 문장으로 정리하면 무엇인가요?",
            "오늘 자신을 자랑스럽게 만든 일이 있나요?",
            "지금 감사한 한 가지를 말해줄래요?",
            "오늘 불안하거나 걱정되는 일이 있었나요?",
            "오늘 웃었던 이유가 있다면 무엇인가요?",
            "오늘 짜증이 났던 일은 무엇인가요?",
            "최근에 눈물이 날 만큼 슬펐던 적이 있나요?",
            "오늘 외로움을 느꼈나요?",
            "지금 해소하고 싶은 감정은 무엇인가요?"
        ],
        "stress": [
            "오늘 스트레스 지수는 어느 정도였나요?",
            "오늘 피곤함의 원인은 무엇 같나요?",
            "오늘 걱정이나 불안으로 집중이 어려웠나요?",
            "최근에 스트레스를 푼 방법은 무엇인가요?",
            "오늘 무언가를 포기했던 적이 있나요?",
            "오늘 지나치게 걱정한 일은 무엇이었나요?",
            "오늘 누군가와의 갈등이 있었다면 원인은 무엇인가요?",
            "오늘 감정이 불안정하다고 느낀 순간이 있었나요?",
            "지금 마음의 무게를 1~10으로 표현한다면?",
            "오늘 자신을 속이거나 숨긴 감정이 있나요?"
        ],
        "physical": [
            "오늘 아침 기상 기분은 어땠나요?",
            "오늘 수면은 충분했나요?",
            "오늘 몸이 편안했나요?",
            "오늘 신체에서 불편한 부위가 있었나요?",
            "오늘 에너지 레벨을 0~10으로 말해주실래요?",
            "최근 며칠간 식사 패턴은 어땠나요?",
            "현재 배고픔이나 식욕 상태는 어떤가요?",
            "오늘 자연(산책, 햇볕 등)과 접한 적 있나요?",
            "지금 휴식이 필요하다고 느끼나요?",
            "오늘 불면증이나 수면 방해가 있었나요?"
        ],
        "social": [
            "오늘 누구와 대화했을 때 편안했나요?",
            "오늘 누군가에게 고마움을 느낀 적이 있나요?",
            "지금 누구에게서 위안을 받고 싶나요?",
            "오늘 누군가에게 도움받았거나 도왔나요?",
            "오늘 자신에게 친절했나요?",
            "오늘 누군가의 말에 상처받은 적이 있나요?",
            "지금 누군가와 이야기하고 싶다면 누구인가요?",
            "오늘 대화 중 감정을 솔직하게 표현했나요?",
            "오늘 주변 사람과의 관계는 어땠나요?",
            "최근 가장 감사한 사람은 누구인가요?"
        ],
        "self_reflection": [
            "오늘 자신에게 한 칭찬은 무엇인가요?",
            "오늘 작은 성공은 무엇이었나요?",
            "오늘 무언가를 배우거나 깨달은 게 있나요?",
            "오늘 목표를 이루는 데 도움이 되는 행동을 했나요?",
            "지금 자신에게 필요한 것은 무엇이라 생각하나요?",
            "지금 미래에 대해 희망적이라고 느끼나요?",
            "오늘 일상 루틴에서 벗어난 일이 있었나요?",
            "오늘 자신을 돌보기 위해 한 작은 행동은 무엇인가요?",
            "오늘 저녁 이후 어떤 기분으로 잠들고 싶나요?",
            "오늘 하루 중 가장 기뻤던 순간은 언제였나요?",
            "오늘 일을 마친 뒤 기분은 어땠나요?",
            "오늘 집중하기 쉬웠나요?",
            "오늘 무언가를 기대하고 있나요?",
            "지금 하고 싶은 한 가지는 무엇인가요?",
            "최근 일주일 중 가장 괜찮았던 날은 언제였나요?"
        ]
    }
    
    db = SessionLocal()
    try:
        # 기존 질문이 있는지 확인
        existing_count = db.query(Question).count()
        if existing_count > 0:
            print(f"⚠️  이미 {existing_count}개의 질문이 존재합니다. 건너뜁니다.")
            return
        
        # 카테고리별로 질문 생성
        total_count = 0
        for category, questions in questions_data.items():
            for question_text in questions:
                question = Question(
                    question_category=category,
                    content=question_text
                )
                db.add(question)
                total_count += 1
        
        db.commit()
        print(f"✅ {total_count}개의 질문이 성공적으로 추가되었습니다!")
        
        # 카테고리별 통계 출력
        for category in questions_data.keys():
            count = db.query(Question).filter(Question.question_category == category).count()
            print(f"  - {category}: {count}개")
            
    except Exception as e:
        db.rollback()
        print(f"❌ 질문 추가 실패: {e}")
        raise
    finally:
        db.close()


if __name__ == "__main__":
    print("📝 질문 데이터 초기화 시작...")
    init_questions()
